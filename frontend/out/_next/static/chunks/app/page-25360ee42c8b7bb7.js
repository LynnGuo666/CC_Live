(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7988:function(e,s,t){Promise.resolve().then(t.bind(t,6117))},6117:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return v}});var a=t(7437),l=t(2265),r=t(7648),n=t(9474),i=t(8124),c=t(1047),d=t(1723),x=t(5805),o=t(284),m=t(2208),h=t(3276),u=t(7168),g=t(3247),p=t(740),j=t(2906),f=t(572);let b=e=>{let{tournament:s}=e;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow border border-gray-200 border-l-4 border-l-orange-500",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(n.Z,{className:"w-5 h-5 text-orange-500"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:s.title})]}),s.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:s.description})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-white ".concat((e=>{switch(e){case"in_progress":return"bg-green-500";case"pending":return"bg-yellow-500";case"finished":return"bg-gray-500";default:return"bg-blue-500"}})(s.status)),children:(e=>{switch(e){case"in_progress":return"进行中";case"pending":return"等待开始";case"finished":return"已结束";default:return e}})(s.status)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"多阶段锦标赛"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:s.created_at&&(0,j.Z)(new Date(s.created_at),{addSuffix:!0,locale:f.Z})})]}),s.start_time&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:new Date(s.start_time).toLocaleString("zh-CN")})]}),s.max_participants&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["最多",s.max_participants,"人"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["锦标赛ID: ",s.id]}),(0,a.jsx)(r.default,{href:"/tournament/".concat(s.id),children:(0,a.jsxs)("button",{className:"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors flex items-center space-x-2",children:[(0,a.jsx)(n.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"观看锦标赛"})]})})]})]})})},N=e=>{let{match:s}=e;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow border border-gray-200",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s.title}),s.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:s.description})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-white ".concat((e=>{switch(e){case"in_progress":return"bg-green-500";case"pending":return"bg-yellow-500";case"finished":return"bg-gray-500";default:return"bg-blue-500"}})(s.status)),children:(e=>{switch(e){case"in_progress":return"进行中";case"pending":return"等待开始";case"finished":return"已结束";default:return e}})(s.status)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:s.game_type||"小游戏"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:s.created_at&&(0,j.Z)(new Date(s.created_at),{addSuffix:!0,locale:f.Z})})]}),s.start_time&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:new Date(s.start_time).toLocaleString("zh-CN")})]}),s.bilibili_url&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"支持视频直播"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["ID: ",s.id]}),(0,a.jsx)(r.default,{href:"/live/".concat(s.id),children:(0,a.jsxs)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"观看直播"})]})})]})]})})};function v(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)([]),[i,c]=(0,l.useState)([]),[d,x]=(0,l.useState)([]),[m,h]=(0,l.useState)(!0),[j,f]=(0,l.useState)(""),[v,w]=(0,l.useState)("all"),[y,_]=(0,l.useState)("all"),Z=async()=>{try{h(!0);let[e,t]=await Promise.all([fetch("/api/tournament/tournaments"),fetch("/api/matches/")]);if(e.ok){let t=await e.json();s(t),c(t)}if(t.ok){let e=await t.json();r(e),x(e)}}catch(e){console.error("获取数据失败:",e)}finally{h(!1)}};return(0,l.useEffect)(()=>{Z()},[]),(0,l.useEffect)(()=>{let s=e,a=t;if("all"!==v&&(s=s.filter(e=>e.status===v),a=a.filter(e=>e.status===v)),j.trim()){let e=j.toLowerCase();s=s.filter(s=>{var t;return s.title.toLowerCase().includes(e)||(null===(t=s.description)||void 0===t?void 0:t.toLowerCase().includes(e))||s.id.toLowerCase().includes(e)}),a=a.filter(s=>{var t,a;return s.title.toLowerCase().includes(e)||(null===(t=s.description)||void 0===t?void 0:t.toLowerCase().includes(e))||(null===(a=s.game_type)||void 0===a?void 0:a.toLowerCase().includes(e))||s.id.toLowerCase().includes(e)})}c(s),x(a)},[e,t,j,v]),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"MC小游戏比赛直播"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"观看实时锦标赛和比赛直播"})]}),(0,a.jsxs)("button",{onClick:Z,disabled:m,className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:bg-gray-400 transition-colors flex items-center space-x-2",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 ".concat(m?"animate-spin":"")}),(0,a.jsx)("span",{children:"刷新"})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:"text",placeholder:"搜索锦标赛、比赛标题、描述或ID...",value:j,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 text-gray-400"}),(0,a.jsxs)("select",{value:v,onChange:e=>w(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"全部状态"}),(0,a.jsx)("option",{value:"pending",children:"等待开始"}),(0,a.jsx)("option",{value:"in_progress",children:"进行中"}),(0,a.jsx)("option",{value:"finished",children:"已结束"})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>_("all"),className:"px-3 py-1 rounded-full text-sm transition-colors ".concat("all"===y?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"全部"}),(0,a.jsxs)("button",{onClick:()=>_("tournaments"),className:"px-3 py-1 rounded-full text-sm transition-colors flex items-center space-x-1 ".concat("tournaments"===y?"bg-orange-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,a.jsx)(n.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"锦标赛"})]}),(0,a.jsxs)("button",{onClick:()=>_("matches"),className:"px-3 py-1 rounded-full text-sm transition-colors flex items-center space-x-1 ".concat("matches"===y?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,a.jsx)(o.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"独立比赛"})]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:j||"all"!==v?(0,a.jsxs)("span",{children:["找到 ",i.length," 个锦标赛，",d.length," 场独立比赛"]}):(0,a.jsxs)("span",{children:["共 ",e.length," 个锦标赛，",t.length," 场独立比赛"]})})]})}),(()=>{if(m)return(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"加载数据中..."})]});let e="all"===y||"tournaments"===y,s="all"===y||"matches"===y;return e&&i.length>0||s&&d.length>0?(0,a.jsxs)("div",{className:"space-y-8",children:[e&&i.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[(0,a.jsx)(n.Z,{className:"w-6 h-6 text-orange-500"}),(0,a.jsxs)("span",{children:["锦标赛 (",i.length,")"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(e=>(0,a.jsx)(b,{tournament:e},e.id))})]}),s&&d.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"w-6 h-6 text-blue-500"}),(0,a.jsxs)("span",{children:["独立比赛 (",d.length,")"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(e=>(0,a.jsx)(N,{match:e},e.id))})]})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(o.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:j||"all"!==v?"未找到匹配的内容":"暂无比赛"}),(0,a.jsx)("p",{className:"text-gray-600",children:j||"all"!==v?"尝试调整搜索条件或筛选器":"等待比赛开始或创建新比赛"})]})})()]})]})}}},function(e){e.O(0,[203,610,971,117,744],function(){return e(e.s=7988)}),_N_E=e.O()}]);