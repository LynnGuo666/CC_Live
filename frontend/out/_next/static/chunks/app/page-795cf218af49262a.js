(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7988:function(e,s,t){Promise.resolve().then(t.bind(t,5744))},5744:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return V}});var a=t(7437),l=t(2265),r=t(3464);let n="http://localhost:8000/api";var c=t(9474),i=t(8060),d=t(5805),x=t(284),o=t(1723);let m={gaming:"bg-green-500",voting:"bg-blue-500",halfing:"bg-yellow-500",setting:"bg-gray-500"},h={gaming:"游戏中",voting:"投票中",halfing:"中场休息",setting:"设置中"};function u(e){var s,t;let{tournament:l,gameStatus:r,viewerCount:n,onToggleVoting:u}=e,g=(null==r?void 0:r.status)||(null==l?void 0:l.status)||"setting",j=(null==r?void 0:null===(s=r.game)||void 0===s?void 0:s.name)||(null==l?void 0:l.current_game)||"待定",v=(null==r?void 0:null===(t=r.game)||void 0===t?void 0:t.round)||(null==l?void 0:l.current_round)||1;return(0,a.jsx)("div",{className:"bg-gray-800 border-b border-gray-700 px-6 py-4",children:(0,a.jsxs)("div",{className:"container mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(c.Z,{className:"w-8 h-8 text-yellow-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white",children:(null==l?void 0:l.name)||"Minecraft锦标赛"}),(0,a.jsxs)("p",{className:"text-gray-400 text-sm",children:["实时直播 \xb7 第",v,"轮"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[u&&(0,a.jsxs)("button",{onClick:u,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"投票展示"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-gray-300",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"text-lg font-semibold",children:n}),(0,a.jsx)("span",{className:"text-sm",children:"在线观看"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"当前游戏"}),(0,a.jsx)("div",{className:"text-white font-semibold",children:j})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(m[g]," ").concat("gaming"===g?"game-status-gaming":"")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"状态"}),(0,a.jsx)("div",{className:"text-white font-semibold",children:h[g]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-green-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"预估剩余时间"}),(0,a.jsx)("div",{className:"text-white font-semibold",children:"15:30"})]})]})]}),(0,a.jsxs)("div",{className:"flex-1 max-w-md mx-8",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-400 mb-1",children:[(0,a.jsx)("span",{children:"锦标赛进度"}),(0,a.jsx)("span",{children:"65%"})]}),(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300",style:{width:"65%"}})})]})]})]})})}var g=t(8617),j=t(6142),v=t(525);let N={RED:"#FF0000",ORANGE:"#FFA500",BLUE:"#0000FF",GREEN:"#00FF00",YELLOW:"#FFFF00",CYAN:"#00FFFF",PURPLE:"#800080",WHITE:"#FFFFFF",PINK:"#FFC0CB",BROWN:"#A52A2A",LIGHT_BLUE:"#ADD8E6",LIGHT_GRAY:"#D3D3D3"},f=e=>{switch(e){case 1:return(0,a.jsx)(g.Z,{className:"w-5 h-5 text-yellow-400"});case 2:return(0,a.jsx)(j.Z,{className:"w-5 h-5 text-gray-400"});case 3:return(0,a.jsx)(c.Z,{className:"w-5 h-5 text-amber-600"});default:return(0,a.jsxs)("span",{className:"w-5 h-5 flex items-center justify-center text-sm font-bold text-gray-400",children:["#",e]})}};function b(e){let{leaderboard:s,scores:t}=e,[r,n]=(0,l.useState)("teams"),i=(0,l.useMemo)(()=>{if(!s)return null;let e=s.players.map(e=>({...e,liveScore:t[e.name]||e.score,scoreChange:(t[e.name]||e.score)-e.score})).sort((e,s)=>s.liveScore-e.liveScore),a={};return e.forEach(e=>{a[e.team]||(a[e.team]=0),a[e.team]+=e.liveScore}),{teams:s.teams.map(e=>({...e,liveScore:a[e.name]||e.score,scoreChange:(a[e.name]||e.score)-e.score})).sort((e,s)=>s.liveScore-e.liveScore),players:e}},[s,t]);return i?(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center",children:[(0,a.jsx)(c.Z,{className:"w-6 h-6 mr-2 text-yellow-400"}),"积分榜"]}),(0,a.jsxs)("div",{className:"flex bg-gray-700 rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>n("teams"),className:"px-3 py-1 rounded text-sm transition-colors ".concat("teams"===r?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 inline mr-1"}),"队伍"]}),(0,a.jsxs)("button",{onClick:()=>n("players"),className:"px-3 py-1 rounded text-sm transition-colors ".concat("players"===r?"bg-blue-600 text-white":"text-gray-400 hover:text-white"),children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 inline mr-1"}),"个人"]})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full overflow-y-auto custom-scrollbar",children:"teams"===r?(0,a.jsx)("div",{className:"space-y-3",children:i.teams.map((e,s)=>(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-4 hover:bg-gray-600 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[f(s+1),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-500",style:{backgroundColor:N[e.name]||"#888"}}),(0,a.jsx)("span",{className:"font-semibold text-white",children:e.name})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:e.liveScore}),0!==e.scoreChange&&(0,a.jsxs)("div",{className:"text-sm ".concat(e.scoreChange>0?"text-green-400":"text-red-400"),children:[e.scoreChange>0?"+":"",e.scoreChange]})]})]})},e.name))}):(0,a.jsx)("div",{className:"space-y-2",children:i.players.map((e,s)=>(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[f(s+1),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-white text-sm",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:e.team})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-bold text-white",children:e.liveScore}),0!==e.scoreChange&&(0,a.jsxs)("div",{className:"text-xs ".concat(e.scoreChange>0?"text-green-400":"text-red-400"),children:[e.scoreChange>0?"+":"",e.scoreChange]})]})]})},e.name))})})}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:(0,a.jsxs)("div",{className:"text-center text-sm text-gray-400",children:["实时更新 • 共",i.teams.length,"支队伍 • ",i.players.length,"名玩家"]})})]}):(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 h-full",children:(0,a.jsxs)("div",{className:"text-center text-gray-400",children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"积分榜加载中..."})]})})}var p=t(8896),y=t(395),w=t(1239),F=t(4401);let D={Item_Found:(0,a.jsx)(p.Z,{className:"w-4 h-4"}),Kill:(0,a.jsx)(y.Z,{className:"w-4 h-4"}),Player_Tagged:(0,a.jsx)(w.Z,{className:"w-4 h-4"}),Wool_Win:(0,a.jsx)(g.Z,{className:"w-4 h-4"}),Player_Fall:(0,a.jsx)(F.Z,{className:"w-4 h-4"}),Death:(0,a.jsx)(F.Z,{className:"w-4 h-4"}),Checkpoint:(0,a.jsx)(p.Z,{className:"w-4 h-4"})},C={Item_Found:"text-green-400",Kill:"text-red-400",Player_Tagged:"text-yellow-400",Wool_Win:"text-purple-400",Player_Fall:"text-orange-400",Death:"text-red-500",Checkpoint:"text-blue-400"},S={Item_Found:"找到物品",Kill:"击杀",Player_Tagged:"被标记",Wool_Win:"羊毛获胜",Player_Fall:"掉落",Death:"淘汰",Checkpoint:"到达检查点",Round_Start:"回合开始",Round_Over:"回合结束",Chaser_Selected:"选为追击者"},k=e=>new Date(e).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),E={RED:"#FF0000",ORANGE:"#FFA500",BLUE:"#0000FF",GREEN:"#00FF00",YELLOW:"#FFFF00",CYAN:"#00FFFF",PURPLE:"#800080",WHITE:"#FFFFFF",PINK:"#FFC0CB",BROWN:"#A52A2A",LIGHT_BLUE:"#ADD8E6",LIGHT_GRAY:"#D3D3D3"};function Z(e){let{events:s,scores:t}=e,r=(0,l.useRef)(null);return(0,l.useEffect)(()=>{r.current&&s.length>0&&(r.current.scrollTop=0)},[s]),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center",children:[(0,a.jsx)(F.Z,{className:"w-6 h-6 mr-2 text-blue-400"}),"实时事件动态"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:[s.length," 条最新事件"]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)("div",{ref:r,className:"h-full overflow-y-auto custom-scrollbar space-y-2",children:0===s.length?(0,a.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,a.jsx)(F.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"等待游戏事件..."})]}):s.map((e,s)=>(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-4 hover:bg-gray-600 transition-all duration-300 event-enter",style:{animationDelay:"".concat(.1*s,"s")},children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-gray-600 ".concat(C[e.event]||"text-gray-400"),children:D[e.event]||(0,a.jsx)(F.Z,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[e.player&&(0,a.jsx)("span",{className:"font-semibold text-white truncate",children:e.player}),e.team&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full border border-gray-500",style:{backgroundColor:E[e.team]||"#888"}}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:e.team})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-300 mb-1",children:[S[e.event]||e.event,e.lore&&(0,a.jsxs)("span",{className:"text-gray-400 ml-1",children:["\xb7 ",e.lore]})]}),e.score_predictions&&Object.keys(e.score_predictions).length>0&&(0,a.jsxs)("div",{className:"text-xs text-green-400 bg-green-900/20 rounded px-2 py-1 mt-2",children:[(0,a.jsx)("span",{className:"opacity-75",children:"预测分数: "}),Object.entries(e.score_predictions).map(e=>{let[s,t]=e;return(0,a.jsxs)("span",{className:"mr-2",children:[s,": +",t]},s)})]})]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-400 whitespace-nowrap ml-2",children:k(e.timestamp)})]})},"".concat(e.timestamp,"-").concat(s)))})}),(0,a.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[(0,a.jsx)("span",{children:"实时更新中"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,a.jsx)("span",{children:"在线"})]})]})})]})}var _=t(2718),T=t(1422),I=t(4743);let A=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE","#85C1E9"],B=()=>A[Math.floor(Math.random()*A.length)],O=[{id:"1",username:"观众1",message:"白队加油！",timestamp:new Date().toISOString(),color:"#FF6B6B"},{id:"2",username:"MinecraftFan",message:"这个宾果时速好精彩",timestamp:new Date().toISOString(),color:"#4ECDC4"},{id:"3",username:"游戏爱好者",message:"Venti_Lynn操作太强了！",timestamp:new Date().toISOString(),color:"#45B7D1"}];function L(e){let{isConnected:s,viewerCount:t}=e,[r,n]=(0,l.useState)(O),[c,i]=(0,l.useState)(""),[x,o]=(0,l.useState)(""),[m,h]=(0,l.useState)(!1),u=(0,l.useRef)(null),g=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(!s)return;let e=setInterval(()=>{let e=["太精彩了！","这波操作6666","红队加油！","预测白队能拿冠军","这个游戏规则太有趣了","主播解说得很棒","淡蓝队的Venti_Lynn厉害","期待最终对决","分数咬得好紧啊","这个翻盘太刺激了"],s=["游戏迷","MC玩家","观众"+Math.floor(1e3*Math.random()),"路人甲","电竞爱好者","弹幕达人","MinecraftLover"],t=e[Math.floor(Math.random()*e.length)],a=s[Math.floor(Math.random()*s.length)],l={id:Date.now().toString(),username:a,message:t,timestamp:new Date().toISOString(),color:B()};n(e=>[...e.slice(-49),l])},8e3*Math.random()+2e3);return()=>clearInterval(e)},[s]),(0,l.useEffect)(()=>{var e;null===(e=u.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[r]);let j=()=>{var e;if(!c.trim()||!x.trim())return;let s={id:Date.now().toString(),username:x.trim(),message:c.trim(),timestamp:new Date().toISOString(),color:B()};n(e=>[...e.slice(-49),s]),i(""),null===(e=g.current)||void 0===e||e.focus()},v=e=>new Date(e).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit"});return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center",children:[(0,a.jsx)(_.Z,{className:"w-6 h-6 mr-2 text-green-400"}),"弹幕聊天"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:t})]})]}),!x&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-gray-700 rounded-lg",children:(0,a.jsx)("input",{type:"text",placeholder:"输入昵称开始聊天...",className:"w-full bg-transparent text-white placeholder-gray-400 outline-none",onKeyPress:e=>{"Enter"===e.key&&o(e.currentTarget.value)}})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden mb-4",children:(0,a.jsxs)("div",{className:"h-full overflow-y-auto custom-scrollbar space-y-2",children:[r.map(e=>(0,a.jsx)("div",{className:"animate-slide-up",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm font-semibold shrink-0",style:{color:e.color},children:[e.username,":"]}),(0,a.jsx)("span",{className:"text-sm text-gray-200 break-words",children:e.message}),(0,a.jsx)("span",{className:"text-xs text-gray-500 shrink-0 ml-auto",children:v(e.timestamp)})]})},e.id)),(0,a.jsx)("div",{ref:u})]})}),x&&(0,a.jsxs)("div",{className:"space-y-3",children:[m&&(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-2",children:(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["\uD83D\uDE00","\uD83D\uDE02","\uD83D\uDE0D","\uD83E\uDD14","\uD83D\uDE0E","\uD83D\uDD25","\uD83D\uDCAA","\uD83D\uDC4F","❤️","⚡"].map(e=>(0,a.jsx)("button",{onClick:()=>{var s;i(s=>s+e),h(!1),null===(s=g.current)||void 0===s||s.focus()},className:"p-2 hover:bg-gray-600 rounded text-lg",children:e},e))})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>h(!m),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded",children:(0,a.jsx)(T.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("input",{ref:g,type:"text",value:c,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},placeholder:"输入弹幕消息...",className:"w-full bg-gray-700 text-white placeholder-gray-400 rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500",maxLength:100,disabled:!s}),(0,a.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500",children:[c.length,"/100"]})]}),(0,a.jsx)("button",{onClick:j,disabled:!c.trim()||!s,className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,a.jsx)(I.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[(0,a.jsxs)("span",{children:["当前用户: ",x]}),(0,a.jsx)("button",{onClick:()=>o(""),className:"hover:text-white transition-colors",children:"切换用户"})]})]}),!s&&(0,a.jsx)("div",{className:"text-center text-red-400 text-sm",children:"连接断开，无法发送消息"})]})}var R=t(9897);let W={宾果时速:"在有限的时间里，尽可能多和快地收集宾果所要求的物品",跑酷追击:"在跑酷的竞技场中，抓住所有对手，或者尽可能在对手的追击下存活更长时间",斗战方框:"在有限的空间内与对手决斗，击杀对手并通过填满场地中央的羊毛方框来取得胜利",TNT飞跃:"踩中的方块会消失！尽量比其他玩家活得更久",空岛乱斗:"在天空中收集资源、搭建桥梁，并在不断缩小的活动空域内尽可能长时间地存活并击杀对手",烫手鳕鱼:"新鲜出炉的烫手鳕鱼！在被烫到受不了之前将鳕鱼扔给其他人",跑路战士:"SCC跑酷激情回归，等等......跑路？闯过一系列跑酷关卡，尝试抵达终点",躲避箭:"最终对决：躲闪对手的射击，通过命中淘汰对手"},M={gaming:"text-green-400",voting:"text-blue-400",halfing:"text-yellow-400",setting:"text-gray-400"},P={gaming:"游戏进行中",voting:"投票选择中",halfing:"中场休息",setting:"游戏设置中"};function G(e){var s,t;let{gameStatus:l,tournament:r}=e,n=(null==l?void 0:null===(s=l.game)||void 0===s?void 0:s.name)||(null==r?void 0:r.current_game)||"等待开始",c=(null==l?void 0:null===(t=l.game)||void 0===t?void 0:t.round)||(null==r?void 0:r.current_round)||1,i=(null==l?void 0:l.status)||(null==r?void 0:r.status)||"setting";return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg overflow-hidden h-full flex flex-col",children:[(0,a.jsx)("div",{className:"bg-gray-700 px-6 py-4 border-b border-gray-600",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(R.Z,{className:"w-6 h-6 text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white",children:n}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:["第 ",c," 轮"]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 ".concat(M[i]),children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-current ".concat("gaming"===i?"animate-pulse":"")}),(0,a.jsx)("span",{className:"font-semibold",children:P[i]})]})})]})}),(0,a.jsx)("div",{className:"flex-1 p-6",children:"等待开始"===n?(0,a.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(x.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-500"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"等待游戏开始"}),(0,a.jsx)("p",{className:"text-gray-400",children:"锦标赛即将开始，请耐心等待..."})]})}):(0,a.jsx)("div",{className:"h-full",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg h-full min-h-64 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(R.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-500"}),(0,a.jsx)("p",{className:"text-gray-400",children:"游戏直播画面"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[n," - 第",c,"轮"]})]})}),"gaming"===i&&(0,a.jsx)("div",{className:"absolute top-4 left-4",children:(0,a.jsxs)("div",{className:"bg-red-600 text-white px-3 py-1 rounded-full text-sm font-semibold flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),(0,a.jsx)("span",{children:"LIVE"})]})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 mr-2 text-blue-400"}),"游戏介绍"]}),(0,a.jsx)("p",{className:"text-gray-300 leading-relaxed",children:W[n]||"精彩的Minecraft竞技游戏"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 mr-2 text-green-400"}),"游戏信息"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-white",children:["#",c]}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"当前轮次"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:"12"}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"参赛队伍"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:"48"}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"参赛玩家"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:"15:30"}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"预估时长"})]})]})]}),"gaming"===i&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2 text-purple-400"}),"实时信息"]}),(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"游戏状态"}),(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:"进行中"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"当前轮次"}),(0,a.jsxs)("span",{className:"text-white",children:["第 ",c," 轮"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"游戏模式"}),(0,a.jsx)("span",{className:"text-white",children:n})]})]})})]})]})]})})})]})}var K=t(6221);let H={宾果时速:"Bingo But Fast",跑酷追击:"Parkour Tag",斗战方框:"Battle Box",TNT飞跃:"TNT Spleef",空岛乱斗:"Sky Brawl",烫手鳕鱼:"Hoty Cody Dusky",跑路战士:"Runaway Warrior"},U={宾果时速:"收集指定物品的竞速游戏",跑酷追击:"追击与逃脱的竞技游戏",斗战方框:"团队战斗与策略游戏",TNT飞跃:"避免掉落的生存游戏",空岛乱斗:"资源收集与战斗游戏",烫手鳕鱼:"传递与生存挑战",跑路战士:"跑酷与技巧挑战"};function Y(e){let{votingData:s,readOnlyMode:t=!1}=e,[r,n]=(0,l.useState)(""),[d,x]=(0,l.useState)(!1),m=s.reduce((e,s)=>e+s.ticket,0),h=[...s].sort((e,s)=>s.ticket-e.ticket),u=e=>0===m?0:Math.round(e/m*100),g=e=>["bg-gradient-to-r from-yellow-400 to-orange-500","bg-gradient-to-r from-gray-300 to-gray-400","bg-gradient-to-r from-amber-600 to-amber-700","bg-gradient-to-r from-blue-400 to-blue-500","bg-gradient-to-r from-green-400 to-green-500","bg-gradient-to-r from-purple-400 to-purple-500","bg-gradient-to-r from-pink-400 to-pink-500"][e]||"bg-gradient-to-r from-gray-400 to-gray-500";return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center",children:[(0,a.jsx)(i.Z,{className:"w-6 h-6 mr-2 text-blue-400"}),t?"投票结果展示":"游戏投票"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(K.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["总票数: ",m]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"投票中"})]})]})]}),(0,a.jsxs)("div",{className:"grid ".concat(t?"grid-cols-1":"grid-cols-1 lg:grid-cols-2"," gap-6"),children:[!t&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"选择下一个游戏"}),Object.keys(H).map(e=>(0,a.jsx)("button",{onClick:()=>!d&&n(e),disabled:d,className:"w-full text-left p-4 rounded-lg border-2 transition-all ".concat(r===e?"border-blue-500 bg-blue-900/30":"border-gray-600 bg-gray-700 hover:border-gray-500 hover:bg-gray-600"," ").concat(d?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-white",children:e}),(0,a.jsx)("div",{className:"text-sm text-gray-400 mt-1",children:U[e]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:H[e]})]}),r===e&&(0,a.jsx)(c.Z,{className:"w-5 h-5 text-blue-400"})]})},e)),(0,a.jsx)("button",{onClick:()=>{r&&(x(!0),setTimeout(()=>{x(!1),n("")},3e3))},disabled:!r||d,className:"w-full py-3 rounded-lg font-semibold transition-all ".concat(!r||d?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:d?"投票成功!":"投票"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"实时投票结果"}),0===h.length?(0,a.jsxs)("div",{className:"text-center text-gray-400 py-8",children:[(0,a.jsx)(i.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"暂无投票数据"})]}):(0,a.jsx)("div",{className:"space-y-3",children:h.map((e,s)=>(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[s<3&&(0,a.jsx)(c.Z,{className:"w-4 h-4 ".concat(0===s?"text-yellow-400":1===s?"text-gray-400":"text-amber-600")}),(0,a.jsx)("span",{className:"font-semibold text-white",children:e.game})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:e.ticket}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:[u(e.ticket),"%"]})]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-600 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat(g(s)),style:{width:"".concat(u(e.ticket),"%")}})})]},e.game))}),m>0&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-gray-700 rounded-lg",children:(0,a.jsx)("div",{className:"text-sm text-gray-300 text-center",children:"实时更新 • 票数最高的游戏将会被选中"})})]})]})]})}function V(){let{tournament:e,leaderboard:s,isLoading:t,refreshData:c}=function(){let[e,s]=(0,l.useState)(null),[t,a]=(0,l.useState)(null),[c,i]=(0,l.useState)(!0),[d,x]=(0,l.useState)(null),o=(0,l.useCallback)(async()=>{try{let e=await r.Z.get("".concat(n,"/tournament"));s(e.data)}catch(e){console.error("Failed to fetch tournament data:",e),x("Failed to fetch tournament data")}},[]),m=(0,l.useCallback)(async()=>{try{let e=await r.Z.get("".concat(n,"/leaderboard"));a(e.data)}catch(e){console.error("Failed to fetch leaderboard:",e),x("Failed to fetch leaderboard")}},[]),h=(0,l.useCallback)(async()=>{i(!0),x(null);try{await Promise.all([o(),m()])}finally{i(!1)}},[o,m]),u=(0,l.useCallback)(async e=>{try{return await r.Z.post("".concat(n,"/vote/event"),e),!0}catch(e){return console.error("Failed to submit vote:",e),!1}},[]),g=(0,l.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{return(await r.Z.get("".concat(n,"/game/").concat(e,"/events?limit=").concat(s))).data}catch(e){return console.error("Failed to fetch game events:",e),[]}},[]);return(0,l.useEffect)(()=>{h()},[h]),{tournament:e,leaderboard:t,isLoading:c,error:d,refreshData:h,submitVote:u,getGameEvents:g}}(),{isConnected:i,events:d,scores:x,gameStatus:o,viewerCount:m,votingData:h}=function(e){let[s,t]=(0,l.useState)(!1),[a,r]=(0,l.useState)([]),[n,c]=(0,l.useState)({}),[i,d]=(0,l.useState)(null),[x,o]=(0,l.useState)(0),[m,h]=(0,l.useState)([]),u=(0,l.useRef)(null),g=(0,l.useRef)(null),j=(0,l.useRef)(0),v=(0,l.useCallback)(()=>{try{u.current=new WebSocket(e),u.current.onopen=()=>{console.log("WebSocket connected"),t(!0),j.current=0},u.current.onmessage=e=>{try{let s=JSON.parse(e.data);switch(s.type){case"game_event":r(e=>[{...s.data,timestamp:s.data.timestamp||new Date().toISOString()},...e.slice(0,49)]),s.data.score_predictions&&c(e=>({...e,...s.data.score_predictions}));break;case"score_update":if(s.data.scores){let e={};s.data.scores.forEach(s=>{e[s.player]=s.score}),c(s=>({...s,...e}))}break;case"global_event":d(s.data);break;case"vote_event":h(s.data);break;case"viewer_count":o(s.count);break;default:console.log("Unknown message type:",s.type)}}catch(e){console.error("Error parsing WebSocket message:",e)}},u.current.onclose=()=>{console.log("WebSocket disconnected"),t(!1),j.current<5&&(j.current++,g.current=setTimeout(()=>{console.log("Attempting to reconnect... (".concat(j.current,"/").concat(5,")")),v()},5e3*j.current))},u.current.onerror=e=>{console.error("WebSocket error:",e)}}catch(e){console.error("Failed to connect to WebSocket:",e)}},[e]);return(0,l.useEffect)(()=>(v(),()=>{g.current&&clearTimeout(g.current),u.current&&u.current.close()}),[v]),{isConnected:s,events:a,scores:n,gameStatus:i,viewerCount:x,votingData:m,sendMessage:(0,l.useCallback)(e=>{u.current&&u.current.readyState===WebSocket.OPEN&&u.current.send(JSON.stringify(e))},[])}}("ws://localhost:8000/ws/live"),[g,j]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{let e=setInterval(c,1e4);return()=>clearInterval(e)},[c]),t)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-white text-xl",children:"加载中..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white",children:[(0,a.jsx)(u,{tournament:e,gameStatus:o,viewerCount:m,onToggleVoting:()=>j(!g)}),(0,a.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6 h-[calc(100vh-120px)]",children:[(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(b,{leaderboard:s,scores:x})}),(0,a.jsxs)("div",{className:"col-span-6 flex flex-col",children:[g&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(Y,{votingData:h,readOnlyMode:!0})}),(0,a.jsx)("div",{className:"flex-1 mb-4",children:(0,a.jsx)(G,{gameStatus:o,tournament:e})}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(Z,{events:d,scores:x})})]}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(L,{isConnected:i,viewerCount:m})})]})}),(0,a.jsx)("div",{className:"fixed bottom-4 right-4",children:(0,a.jsx)("div",{className:"px-3 py-1 rounded-full text-sm ".concat(i?"bg-green-500 text-white":"bg-red-500 text-white"),children:i?"已连接":"连接断开"})})]})}}},function(e){e.O(0,[478,971,117,744],function(){return e(e.s=7988)}),_N_E=e.O()}]);