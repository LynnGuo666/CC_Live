(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7988:function(e,t,s){Promise.resolve().then(s.bind(s,7080))},7080:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Q}});var a=s(7437),r=s(2265),l=s(3464);let n="http://localhost:8000/api";var c=s(9474),i=s(284),d=s(5805),o=s(7226),x=s(5929),m=s(9734);function h(){let{theme:e,toggleTheme:t}=(0,m.F)();return(0,a.jsx)("button",{onClick:t,className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200","aria-label":"切换主题",title:"light"===e?"切换到深色模式":"切换到浅色模式",children:"light"===e?(0,a.jsx)(o.Z,{className:"w-5 h-5"}):(0,a.jsx)(x.Z,{className:"w-5 h-5"})})}let g={gaming:"bg-green-500",voting:"bg-blue-500",halfing:"bg-yellow-500",setting:"bg-gray-500"},u={gaming:"游戏中",voting:"投票中",halfing:"中场休息",setting:"设置中"};function j(e){var t,s,r,l;let{tournament:n,gameStatus:o,viewerCount:x}=e,m=(null==o?void 0:o.status)||(null==n?void 0:n.status)||"setting",j=(null==o?void 0:null===(t=o.game)||void 0===t?void 0:t.name)||(null==n?void 0:n.current_game)||"待定",v=(null==o?void 0:null===(s=o.game)||void 0===s?void 0:s.round)||(null==n?void 0:n.current_round)||1,y=(null==o?void 0:null===(r=o.game)||void 0===r?void 0:r.game_index)||1,b=(null==o?void 0:null===(l=o.game)||void 0===l?void 0:l.total_games)||1,N=b>1?"".concat(y,"/").concat(b):"";return(0,a.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 border-b border-gray-300 dark:border-gray-700 px-6 py-4",children:(0,a.jsx)("div",{className:"container mx-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(c.Z,{className:"w-8 h-8 text-yellow-500 dark:text-yellow-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==n?void 0:n.name)||"Minecraft锦标赛"}),(0,a.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["实时直播 \xb7 第",v,"轮",N&&" (".concat(N,")")]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5 text-blue-500 dark:text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"当前游戏"}),(0,a.jsx)("div",{className:"text-gray-900 dark:text-white font-semibold",children:j})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(g[m]," ").concat("gaming"===m?"game-status-gaming":"")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"状态"}),(0,a.jsx)("div",{className:"text-gray-900 dark:text-white font-semibold",children:u[m]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-300",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"text-lg font-semibold",children:x}),(0,a.jsx)("span",{className:"text-sm",children:"在线观看"})]}),(0,a.jsx)(h,{})]})]})})})}var v=s(8617),y=s(6142),b=s(525);let N={RED:"#FF0000",ORANGE:"#FFA500",BLUE:"#0000FF",GREEN:"#00FF00",YELLOW:"#FFFF00",CYAN:"#00FFFF",PURPLE:"#800080",WHITE:"#FFFFFF",PINK:"#FFC0CB",BROWN:"#A52A2A",LIGHT_BLUE:"#ADD8E6",LIGHT_GRAY:"#D3D3D3"},f=e=>{switch(e){case 1:return(0,a.jsx)(v.Z,{className:"w-5 h-5 text-yellow-400"});case 2:return(0,a.jsx)(y.Z,{className:"w-5 h-5 text-gray-400"});case 3:return(0,a.jsx)(c.Z,{className:"w-5 h-5 text-amber-600"});default:return(0,a.jsxs)("span",{className:"w-5 h-5 flex items-center justify-center text-sm font-bold text-gray-400",children:["#",e]})}};function p(e){let{leaderboard:t,scores:s}=e,[l,n]=(0,r.useState)("teams"),i=(0,r.useMemo)(()=>{if(!t)return null;let e=t.players.map(e=>({...e,liveScore:s[e.name]||e.score,scoreChange:(s[e.name]||e.score)-e.score})).sort((e,t)=>t.liveScore-e.liveScore),a={};return e.forEach(e=>{a[e.team]||(a[e.team]=0),a[e.team]+=e.liveScore}),{teams:t.teams.map(e=>({...e,liveScore:a[e.name]||e.score,scoreChange:(a[e.name]||e.score)-e.score})).sort((e,t)=>t.liveScore-e.liveScore),players:e}},[t,s]);return i?(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center",children:[(0,a.jsx)(c.Z,{className:"w-6 h-6 mr-2 text-yellow-500 dark:text-yellow-400"}),"积分榜"]}),(0,a.jsxs)("div",{className:"flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>n("teams"),className:"px-3 py-1 rounded text-sm transition-colors ".concat("teams"===l?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 inline mr-1"}),"队伍"]}),(0,a.jsxs)("button",{onClick:()=>n("players"),className:"px-3 py-1 rounded text-sm transition-colors ".concat("players"===l?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:[(0,a.jsx)(b.Z,{className:"w-4 h-4 inline mr-1"}),"个人"]})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full overflow-y-auto custom-scrollbar",children:"teams"===l?(0,a.jsx)("div",{className:"space-y-3",children:i.teams.map((e,t)=>(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-4 hover:bg-gray-600 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[f(t+1),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-500",style:{backgroundColor:N[e.name]||"#888"}}),(0,a.jsx)("span",{className:"font-semibold text-white",children:e.name})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:e.liveScore}),0!==e.scoreChange&&(0,a.jsxs)("div",{className:"text-sm ".concat(e.scoreChange>0?"text-green-400":"text-red-400"),children:[e.scoreChange>0?"+":"",e.scoreChange]})]})]})},e.name))}):(0,a.jsx)("div",{className:"space-y-2",children:i.players.map((e,t)=>(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[f(t+1),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-white text-sm",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:e.team})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-bold text-white",children:e.liveScore}),0!==e.scoreChange&&(0,a.jsxs)("div",{className:"text-xs ".concat(e.scoreChange>0?"text-green-400":"text-red-400"),children:[e.scoreChange>0?"+":"",e.scoreChange]})]})]})},e.name))})})}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:(0,a.jsxs)("div",{className:"text-center text-sm text-gray-400",children:["实时更新 • 共",i.teams.length,"支队伍 • ",i.players.length,"名玩家"]})})]}):(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 h-full",children:(0,a.jsxs)("div",{className:"text-center text-gray-600 dark:text-gray-400",children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"积分榜加载中..."})]})})}var w=s(8896),k=s(395),F=s(1239),D=s(4401);let C={Item_Found:(0,a.jsx)(w.Z,{className:"w-4 h-4"}),Kill:(0,a.jsx)(k.Z,{className:"w-4 h-4"}),Player_Tagged:(0,a.jsx)(F.Z,{className:"w-4 h-4"}),Wool_Win:(0,a.jsx)(v.Z,{className:"w-4 h-4"}),Player_Fall:(0,a.jsx)(D.Z,{className:"w-4 h-4"}),Death:(0,a.jsx)(D.Z,{className:"w-4 h-4"}),Checkpoint:(0,a.jsx)(w.Z,{className:"w-4 h-4"})},S={Item_Found:"text-green-400",Kill:"text-red-400",Player_Tagged:"text-yellow-400",Wool_Win:"text-purple-400",Player_Fall:"text-orange-400",Death:"text-red-500",Checkpoint:"text-blue-400"},E={Item_Found:"找到物品",Kill:"击杀",Player_Tagged:"被标记",Wool_Win:"羊毛获胜",Player_Fall:"掉落",Death:"淘汰",Checkpoint:"到达检查点",Round_Start:"回合开始",Round_Over:"回合结束",Chaser_Selected:"选为追击者"},_=e=>new Date(e).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),Z={RED:"#FF0000",ORANGE:"#FFA500",BLUE:"#0000FF",GREEN:"#00FF00",YELLOW:"#FFFF00",CYAN:"#00FFFF",PURPLE:"#800080",WHITE:"#FFFFFF",PINK:"#FFC0CB",BROWN:"#A52A2A",LIGHT_BLUE:"#ADD8E6",LIGHT_GRAY:"#D3D3D3"};function T(e){let{events:t,scores:s}=e,l=(0,r.useRef)(null);return(0,r.useEffect)(()=>{l.current&&t.length>0&&(l.current.scrollTop=0)},[t]),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center",children:[(0,a.jsx)(D.Z,{className:"w-6 h-6 mr-2 text-blue-400"}),"实时事件动态"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.length," 条最新事件"]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)("div",{ref:l,className:"h-full overflow-y-auto custom-scrollbar space-y-2",children:0===t.length?(0,a.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,a.jsx)(D.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"等待游戏事件..."})]}):t.map((e,t)=>(0,a.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all duration-300 event-enter",style:{animationDelay:"".concat(.1*t,"s")},children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-gray-200 dark:bg-gray-600 ".concat(S[e.event]||"text-gray-600 dark:text-gray-400"),children:C[e.event]||(0,a.jsx)(D.Z,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[e.player&&(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:e.player}),e.team&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full border border-gray-500",style:{backgroundColor:Z[e.team]||"#888"}}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:e.team})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-300 mb-1",children:[E[e.event]||e.event,e.lore&&(0,a.jsxs)("span",{className:"text-gray-600 dark:text-gray-400 ml-1",children:["\xb7 ",e.lore]})]}),e.score_predictions&&Object.keys(e.score_predictions).length>0&&(0,a.jsxs)("div",{className:"text-xs text-green-400 bg-green-900/20 rounded px-2 py-1 mt-2",children:[(0,a.jsx)("span",{className:"opacity-75",children:"预测分数: "}),Object.entries(e.score_predictions).map(e=>{let[t,s]=e;return(0,a.jsxs)("span",{className:"mr-2",children:[t,": +",s]},t)})]})]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 whitespace-nowrap ml-2",children:_(e.timestamp)})]})},"".concat(e.timestamp,"-").concat(t)))})}),(0,a.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("span",{children:"实时更新中"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,a.jsx)("span",{children:"在线"})]})]})})]})}var L=s(2718),A=s(1422),B=s(4743);let I=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE","#85C1E9"],O=()=>I[Math.floor(Math.random()*I.length)],R=[{id:"1",username:"观众1",message:"白队加油！",timestamp:new Date().toISOString(),color:"#FF6B6B"},{id:"2",username:"MinecraftFan",message:"这个宾果时速好精彩",timestamp:new Date().toISOString(),color:"#4ECDC4"},{id:"3",username:"游戏爱好者",message:"Venti_Lynn操作太强了！",timestamp:new Date().toISOString(),color:"#45B7D1"}];function P(e){let{isConnected:t,viewerCount:s}=e,[l,n]=(0,r.useState)(R),[c,i]=(0,r.useState)(""),[o,x]=(0,r.useState)(""),[m,h]=(0,r.useState)(!1);(0,r.useRef)(null);let g=(0,r.useRef)(null),u=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!t)return;let e=setInterval(()=>{let e=["太精彩了！","这波操作6666","红队加油！","预测白队能拿冠军","这个游戏规则太有趣了","主播解说得很棒","淡蓝队的Venti_Lynn厉害","期待最终对决","分数咬得好紧啊","这个翻盘太刺激了"],t=["游戏迷","MC玩家","观众"+Math.floor(1e3*Math.random()),"路人甲","电竞爱好者","弹幕达人","MinecraftLover"],s=e[Math.floor(Math.random()*e.length)],a=t[Math.floor(Math.random()*t.length)],r={id:Date.now().toString(),username:a,message:s,timestamp:new Date().toISOString(),color:O()};n(e=>[...e,r].slice(-30))},8e3*Math.random()+2e3);return()=>clearInterval(e)},[t]),(0,r.useEffect)(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)},[l]);let j=()=>{var e;if(!c.trim()||!o.trim())return;let t={id:Date.now().toString(),username:o.trim(),message:c.trim(),timestamp:new Date().toISOString(),color:O()};n(e=>[...e,t].slice(-30)),i(""),null===(e=g.current)||void 0===e||e.focus()},v=e=>new Date(e).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit"});return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center",children:[(0,a.jsx)(L.Z,{className:"w-6 h-6 mr-2 text-green-500 dark:text-green-400"}),"弹幕聊天"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:s})]})]}),!o&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-gray-100 dark:bg-gray-700 rounded-lg",children:(0,a.jsx)("input",{type:"text",placeholder:"输入昵称开始聊天...",className:"w-full bg-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 outline-none",onKeyPress:e=>{"Enter"===e.key&&x(e.currentTarget.value)}})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden mb-4",children:(0,a.jsx)("div",{ref:u,className:"h-full overflow-y-auto custom-scrollbar space-y-2",children:l.map(e=>(0,a.jsx)("div",{className:"animate-slide-up",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm font-semibold shrink-0",style:{color:e.color},children:[e.username,":"]}),(0,a.jsx)("span",{className:"text-sm text-gray-800 dark:text-gray-200 break-words",children:e.message}),(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-500 shrink-0 ml-auto",children:v(e.timestamp)})]})},e.id))})}),o&&(0,a.jsxs)("div",{className:"space-y-3",children:[m&&(0,a.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-lg p-2",children:(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["\uD83D\uDE00","\uD83D\uDE02","\uD83D\uDE0D","\uD83E\uDD14","\uD83D\uDE0E","\uD83D\uDD25","\uD83D\uDCAA","\uD83D\uDC4F","❤️","⚡"].map(e=>(0,a.jsx)("button",{onClick:()=>{var t;i(t=>t+e),h(!1),null===(t=g.current)||void 0===t||t.focus()},className:"p-2 hover:bg-gray-300 dark:hover:bg-gray-600 rounded text-lg",children:e},e))})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>h(!m),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-300 dark:hover:bg-gray-700 rounded",children:(0,a.jsx)(A.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("input",{ref:g,type:"text",value:c,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},placeholder:"输入弹幕消息...",className:"w-full bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500",maxLength:100,disabled:!t}),(0,a.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-600 dark:text-gray-500",children:[c.length,"/100"]})]}),(0,a.jsx)("button",{onClick:j,disabled:!c.trim()||!t,className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,a.jsx)(B.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 dark:text-gray-400",children:[(0,a.jsxs)("span",{children:["当前用户: ",o]}),(0,a.jsx)("button",{onClick:()=>x(""),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"切换用户"})]})]}),!t&&(0,a.jsx)("div",{className:"text-center text-red-400 text-sm",children:"连接断开，无法发送消息"})]})}var W=s(9897),M=s(1723);let G={宾果时速:"在有限的时间里，尽可能多和快地收集宾果所要求的物品",跑酷追击:"在跑酷的竞技场中，抓住所有对手，或者尽可能在对手的追击下存活更长时间",斗战方框:"在有限的空间内与对手决斗，击杀对手并通过填满场地中央的羊毛方框来取得胜利",TNT飞跃:"踩中的方块会消失！尽量比其他玩家活得更久",空岛乱斗:"在天空中收集资源、搭建桥梁，并在不断缩小的活动空域内尽可能长时间地存活并击杀对手",烫手鳕鱼:"新鲜出炉的烫手鳕鱼！在被烫到受不了之前将鳕鱼扔给其他人",跑路战士:"SCC跑酷激情回归，等等......跑路？闯过一系列跑酷关卡，尝试抵达终点",躲避箭:"最终对决：躲闪对手的射击，通过命中淘汰对手"},H={gaming:"text-green-400",voting:"text-blue-400",halfing:"text-yellow-400",setting:"text-gray-400"},K={gaming:"游戏进行中",voting:"投票选择中",halfing:"中场休息",setting:"游戏设置中"};function U(e){var t,s;let{gameStatus:r,tournament:l}=e,n=(null==r?void 0:null===(t=r.game)||void 0===t?void 0:t.name)||(null==l?void 0:l.current_game)||"等待开始",c=(null==r?void 0:null===(s=r.game)||void 0===s?void 0:s.round)||(null==l?void 0:l.current_round)||1,o=(null==r?void 0:r.status)||(null==l?void 0:l.status)||"setting";return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg overflow-hidden h-full flex flex-col",children:[(0,a.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 px-6 py-4 border-b border-gray-300 dark:border-gray-600",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(W.Z,{className:"w-6 h-6 text-blue-500 dark:text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:n}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["第 ",c," 轮"]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 ".concat(H[o]),children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-current ".concat("gaming"===o?"animate-pulse":"")}),(0,a.jsx)("span",{className:"font-semibold",children:K[o]})]})})]})}),(0,a.jsx)("div",{className:"flex-1 p-6",children:"等待开始"===n?(0,a.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-500"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"等待游戏开始"}),(0,a.jsx)("p",{className:"text-gray-400",children:"锦标赛即将开始，请耐心等待..."})]})}):(0,a.jsx)("div",{className:"h-full",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg h-full min-h-64 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(W.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-500"}),(0,a.jsx)("p",{className:"text-gray-400",children:"游戏直播画面"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[n," - 第",c,"轮"]})]})}),"gaming"===o&&(0,a.jsx)("div",{className:"absolute top-4 left-4",children:(0,a.jsxs)("div",{className:"bg-red-600 text-white px-3 py-1 rounded-full text-sm font-semibold flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),(0,a.jsx)("span",{children:"LIVE"})]})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5 mr-2 text-blue-400"}),"游戏介绍"]}),(0,a.jsx)("p",{className:"text-gray-300 leading-relaxed",children:G[n]||"精彩的Minecraft竞技游戏"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,a.jsx)(M.Z,{className:"w-5 h-5 mr-2 text-green-400"}),"游戏信息"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-white",children:["#",c]}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"当前轮次"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:"12"}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"参赛队伍"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:"48"}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"参赛玩家"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:"15:30"}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"预估时长"})]})]})]}),"gaming"===o&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2 text-purple-400"}),"实时信息"]}),(0,a.jsx)("div",{className:"bg-gray-700 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"游戏状态"}),(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:"进行中"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"当前轮次"}),(0,a.jsxs)("span",{className:"text-white",children:["第 ",c," 轮"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"游戏模式"}),(0,a.jsx)("span",{className:"text-white",children:n})]})]})})]})]})]})})})]})}var Y=s(8060),V=s(6221);let z={宾果时速:"Bingo But Fast",跑酷追击:"Parkour Tag",斗战方框:"Battle Box",TNT飞跃:"TNT Spleef",空岛乱斗:"Sky Brawl",烫手鳕鱼:"Hoty Cody Dusky",跑路战士:"Runaway Warrior"},J={宾果时速:"收集指定物品的竞速游戏",跑酷追击:"追击与逃脱的竞技游戏",斗战方框:"团队战斗与策略游戏",TNT飞跃:"避免掉落的生存游戏",空岛乱斗:"资源收集与战斗游戏",烫手鳕鱼:"传递与生存挑战",跑路战士:"跑酷与技巧挑战"};function q(e){let{votingData:t,readOnlyMode:s=!1}=e,[l,n]=(0,r.useState)(""),[i,d]=(0,r.useState)(!1),o=t.reduce((e,t)=>e+t.ticket,0),x=[...t].sort((e,t)=>t.ticket-e.ticket),m=e=>0===o?0:Math.round(e/o*100),h=e=>["bg-gradient-to-r from-yellow-400 to-orange-500","bg-gradient-to-r from-gray-300 to-gray-400","bg-gradient-to-r from-amber-600 to-amber-700","bg-gradient-to-r from-blue-400 to-blue-500","bg-gradient-to-r from-green-400 to-green-500","bg-gradient-to-r from-purple-400 to-purple-500","bg-gradient-to-r from-pink-400 to-pink-500"][e]||"bg-gradient-to-r from-gray-400 to-gray-500";return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center",children:[(0,a.jsx)(Y.Z,{className:"w-6 h-6 mr-2 text-blue-500 dark:text-blue-400"}),s?"投票结果展示":"游戏投票"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(V.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["总票数: ",o]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(M.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"投票中"})]})]})]}),(0,a.jsxs)("div",{className:"grid ".concat(s?"grid-cols-1":"grid-cols-1 lg:grid-cols-2"," gap-6"),children:[!s&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"选择下一个游戏"}),Object.keys(z).map(e=>(0,a.jsx)("button",{onClick:()=>!i&&n(e),disabled:i,className:"w-full text-left p-4 rounded-lg border-2 transition-all ".concat(l===e?"border-blue-500 bg-blue-900/30":"border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 hover:border-gray-400 dark:hover:border-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600"," ").concat(i?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:e}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:J[e]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:z[e]})]}),l===e&&(0,a.jsx)(c.Z,{className:"w-5 h-5 text-blue-400"})]})},e)),(0,a.jsx)("button",{onClick:()=>{l&&(d(!0),setTimeout(()=>{d(!1),n("")},3e3))},disabled:!l||i,className:"w-full py-3 rounded-lg font-semibold transition-all ".concat(!l||i?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:i?"投票成功!":"投票"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"实时投票结果"}),0===x.length?(0,a.jsxs)("div",{className:"text-center text-gray-400 py-8",children:[(0,a.jsx)(Y.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"暂无投票数据"})]}):(0,a.jsx)("div",{className:"space-y-3",children:x.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[t<3&&(0,a.jsx)(c.Z,{className:"w-4 h-4 ".concat(0===t?"text-yellow-400":1===t?"text-gray-400":"text-amber-600")}),(0,a.jsx)("span",{className:"font-semibold text-white",children:e.game})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:e.ticket}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:[m(e.ticket),"%"]})]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-600 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat(h(t)),style:{width:"".concat(m(e.ticket),"%")}})})]},e.game))}),o>0&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-gray-700 rounded-lg",children:(0,a.jsx)("div",{className:"text-sm text-gray-300 text-center",children:"实时更新 • 票数最高的游戏将会被选中"})})]})]})]})}function Q(){let{tournament:e,leaderboard:t,isLoading:s,refreshData:c}=function(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(null),[c,i]=(0,r.useState)(!0),[d,o]=(0,r.useState)(null),x=(0,r.useCallback)(async()=>{try{let e=await l.Z.get("".concat(n,"/tournament"));t(e.data)}catch(e){console.error("Failed to fetch tournament data:",e),o("Failed to fetch tournament data")}},[]),m=(0,r.useCallback)(async()=>{try{let e=await l.Z.get("".concat(n,"/leaderboard"));a(e.data)}catch(e){console.error("Failed to fetch leaderboard:",e),o("Failed to fetch leaderboard")}},[]),h=(0,r.useCallback)(async()=>{i(!0),o(null);try{await Promise.all([x(),m()])}finally{i(!1)}},[x,m]),g=(0,r.useCallback)(async e=>{try{return await l.Z.post("".concat(n,"/vote/event"),e),!0}catch(e){return console.error("Failed to submit vote:",e),!1}},[]),u=(0,r.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{return(await l.Z.get("".concat(n,"/game/").concat(e,"/events?limit=").concat(t))).data}catch(e){return console.error("Failed to fetch game events:",e),[]}},[]);return(0,r.useEffect)(()=>{h()},[h]),{tournament:e,leaderboard:s,isLoading:c,error:d,refreshData:h,submitVote:g,getGameEvents:u}}(),{isConnected:i,events:d,scores:o,gameStatus:x,viewerCount:m,votingData:h}=function(e){let[t,s]=(0,r.useState)(!1),[a,l]=(0,r.useState)([]),[n,c]=(0,r.useState)({}),[i,d]=(0,r.useState)(null),[o,x]=(0,r.useState)(0),[m,h]=(0,r.useState)([]),g=(0,r.useRef)(null),u=(0,r.useRef)(null),j=(0,r.useRef)(0),v=(0,r.useCallback)(()=>{try{g.current=new WebSocket(e),g.current.onopen=()=>{console.log("WebSocket connected"),s(!0),j.current=0},g.current.onmessage=e=>{try{let t=JSON.parse(e.data);switch(t.type){case"game_event":l(e=>[{...t.data,timestamp:t.data.timestamp||new Date().toISOString()},...e.slice(0,49)]),t.data.score_predictions&&c(e=>({...e,...t.data.score_predictions}));break;case"score_update":if(t.data.scores){let e={};t.data.scores.forEach(t=>{e[t.player]=t.score}),c(t=>({...t,...e}))}break;case"global_event":d(t.data);break;case"vote_event":h(t.data);break;case"viewer_count":x(t.count);break;default:console.log("Unknown message type:",t.type)}}catch(e){console.error("Error parsing WebSocket message:",e)}},g.current.onclose=()=>{console.log("WebSocket disconnected"),s(!1),j.current<5&&(j.current++,u.current=setTimeout(()=>{console.log("Attempting to reconnect... (".concat(j.current,"/").concat(5,")")),v()},5e3*j.current))},g.current.onerror=e=>{console.error("WebSocket error:",e)}}catch(e){console.error("Failed to connect to WebSocket:",e)}},[e]);return(0,r.useEffect)(()=>(v(),()=>{u.current&&clearTimeout(u.current),g.current&&g.current.close()}),[v]),{isConnected:t,events:a,scores:n,gameStatus:i,viewerCount:o,votingData:m,sendMessage:(0,r.useCallback)(e=>{g.current&&g.current.readyState===WebSocket.OPEN&&g.current.send(JSON.stringify(e))},[])}}("ws://localhost:8000/ws/live"),[g,u]=(0,r.useState)(!1);return s?(0,a.jsx)("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-gray-900 dark:text-white text-xl",children:"加载中..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:[(0,a.jsx)(j,{tournament:e,gameStatus:x,viewerCount:m}),(0,a.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6",style:{height:"calc(100vh - 200px)"},children:[(0,a.jsx)("div",{className:"col-span-3 h-full",children:(0,a.jsx)(p,{leaderboard:t,scores:o})}),(0,a.jsxs)("div",{className:"col-span-6 flex flex-col",children:[g&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(q,{votingData:h,readOnlyMode:!0})}),(0,a.jsx)("div",{className:"flex-1 mb-4",children:(0,a.jsx)(U,{gameStatus:x,tournament:e})}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(T,{events:d,scores:o})})]}),(0,a.jsx)("div",{className:"col-span-3 h-full",children:(0,a.jsx)(P,{isConnected:i,viewerCount:m})})]})}),(0,a.jsx)("div",{className:"fixed bottom-4 right-4",children:(0,a.jsx)("div",{className:"px-3 py-1 rounded-full text-sm ".concat(i?"bg-green-500 text-white":"bg-red-500 text-white"),children:i?"已连接":"连接断开"})})]})}},9734:function(e,t,s){"use strict";s.d(t,{F:function(){return c},ThemeProvider:function(){return n}});var a=s(7437),r=s(2265);let l=(0,r.createContext)(void 0);function n(e){let{children:t}=e,[s,n]=(0,r.useState)("dark");return(0,r.useEffect)(()=>{let e=localStorage.getItem("theme");e?n(e):n(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},[]),(0,r.useEffect)(()=>{document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(s),localStorage.setItem("theme",s)},[s]),(0,a.jsx)(l.Provider,{value:{theme:s,toggleTheme:()=>{n(e=>"light"===e?"dark":"light")}},children:t})}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}}},function(e){e.O(0,[948,971,117,744],function(){return e(e.s=7988)}),_N_E=e.O()}]);